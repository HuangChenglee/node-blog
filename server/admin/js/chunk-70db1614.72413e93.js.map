{"version":3,"sources":["webpack:///./src/network/category.js","webpack:///./src/views/categories/Categories.vue?b0ce","webpack:///src/views/categories/Categories.vue","webpack:///./src/views/categories/Categories.vue?f3a2","webpack:///./src/views/categories/Categories.vue"],"names":["addCategory","data","request","url","method","Categories","UpdateCategory","id","DeleteCategory","render","_vm","this","_h","$createElement","_c","_self","attrs","columns","loading","scopedSlots","_u","key","fn","record","on","$event","preventDefault","handleUpdate","_v","showDeleteConfirm","visible","handleOk","handleCancel","form","span","directives","name","rawName","value","rules","required","message","expression","staticRenderFns","created","requestData","$form","createForm","nowId","cateName","methods","_id","console","log","$nextTick","setFieldsValue","$confirm","title","content","okText","okType","cancelText","onOk","description","duration","onCancel","confirmLoading","validateFields","err","values","setTimeout","component"],"mappings":"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","file":"js/chunk-70db1614.72413e93.js","sourcesContent":["import request from './request'\r\n\r\nexport function addCategory(data){\r\n  return request({\r\n    url: 'category/add',\r\n    method: 'post',\r\n    data: data\r\n  })  \r\n}\r\n\r\nexport function Categories(){\r\n  return request({\r\n    url: 'categories',\r\n    method: \"post\"\r\n  })\r\n}\r\n\r\n// 获取单条数据\r\nexport function GetCategory(id){\r\n  return request({\r\n    url: `category/${id}`,\r\n    method: \"get\"\r\n  })\r\n}\r\n\r\nexport function UpdateCategory(id, data){\r\n  return request({\r\n    url: `category/${id}`,\r\n    data: data,\r\n    method: \"put\"\r\n  })\r\n}\r\n\r\nexport function DeleteCategory(id){\r\n  return request({\r\n    url: `category/${id}`,\r\n    method: \"delete\"\r\n  })\r\n}","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('a-table',{attrs:{\"columns\":_vm.columns,\"data-source\":_vm.data,\"loading\":_vm.loading,\"pagination\":false,\"bordered\":\"\"},scopedSlots:_vm._u([{key:\"action\",fn:function(record){return [_c('span',[_c('a',{on:{\"click\":function($event){$event.preventDefault();return _vm.handleUpdate(record)}}},[_vm._v(\"Update\")]),_c('a-divider',{attrs:{\"type\":\"vertical\"}}),_c('a',{on:{\"click\":function($event){$event.preventDefault();return _vm.showDeleteConfirm(record)}}},[_vm._v(\"Delete\")])],1)]}}])}),_c('a-modal',{attrs:{\"title\":\"修改\",\"visible\":_vm.visible},on:{\"ok\":_vm.handleOk,\"cancel\":_vm.handleCancel}},[_c('a-form',{attrs:{\"form\":_vm.form,\"label-col\":{span: 4},\"wrapper-col\":{ span: 12 }}},[_c('a-form-item',{attrs:{\"label\":\"名称\"}},[_c('a-input',{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:(['name', { rules: [{ required: true, message: '请输入分类名' }] }]),expression:\"['name', { rules: [{ required: true, message: '请输入分类名' }] }]\"}]})],1)],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div>\r\n    <a-table :columns=\"columns\" :data-source=\"data\" :loading=\"loading\" :pagination=\"false\" bordered>\r\n      <template slot=\"action\" slot-scope=\"record\">\r\n        <span>\r\n          <a @click.prevent=\"handleUpdate(record)\">Update</a>\r\n          <a-divider type=\"vertical\" />\r\n          <a @click.prevent=\"showDeleteConfirm(record)\">Delete</a>\r\n        </span>\r\n      </template>\r\n    </a-table>\r\n    <a-modal title=\"修改\" :visible=\"visible\" @ok=\"handleOk\" @cancel=\"handleCancel\">\r\n      <a-form :form=\"form\" :label-col=\"{span: 4}\" :wrapper-col=\"{ span: 12 }\">\r\n        <a-form-item label=\"名称\">\r\n          <a-input v-decorator=\"['name', { rules: [{ required: true, message: '请输入分类名' }] }]\" />\r\n        </a-form-item>\r\n      </a-form>\r\n    </a-modal>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {\r\n  Categories,\r\n  UpdateCategory,\r\n  DeleteCategory\r\n} from \"network/category.js\";\r\n\r\nconst columns = [\r\n  // {\r\n  //   title: \"Id\",\r\n  //   dataIndex: \"_id\",\r\n  //   width: 1,\r\n  //   key: \"Id\"\r\n  //   // slots: { title: 'customTitle' }, // 自定义表头\r\n  //   // scopedSlots: { customRender: 'name' }, // 自定义表格中的元素\r\n  // },\r\n  {\r\n    title: \"上级分类\",\r\n    dataIndex: \"parent.name\",\r\n    width: 1,\r\n    key: \"Parent\"\r\n  },\r\n  {\r\n    title: \"分类名\",\r\n    dataIndex: \"name\",\r\n    width: 1,\r\n    key: \"Name\",\r\n    sorter: (a, b) => a.name.length - b.name.length\r\n  },\r\n  {\r\n    title: \"操作\",\r\n    key: \"action\",\r\n    width: 1,\r\n    scopedSlots: { customRender: \"action\" }\r\n  }\r\n];\r\n\r\nexport default {\r\n  created() {\r\n    this.requestData();\r\n  },\r\n  data() {\r\n    return {\r\n      data: [],\r\n      columns,\r\n      visible: false,\r\n      form: this.$form.createForm(this),\r\n      nowId: null, // 记录正在操作的分类的id\r\n      cateName: null, //修改的内容\r\n      loading: false\r\n    };\r\n  },\r\n  methods: {\r\n    handleUpdate(record) {\r\n      this.visible = true;\r\n      // console.log(record)\r\n      this.nowId = record._id;\r\n      this.cateName = record.name;\r\n      console.log(this.nowId);\r\n\r\n      // 在这里等待弹窗dom出现(其实这里也就第一次加载dom时需要，后来都保存了，但终究对操作不友好)\r\n      this.$nextTick(function() {\r\n        // DOM 现在更新了\r\n        // `this` 绑定到当前实例\r\n        this.form.setFieldsValue({\r\n          name: this.cateName\r\n        });\r\n      });\r\n    },\r\n\r\n    showDeleteConfirm(record) {\r\n      this.nowId = record._id;\r\n      console.log(record);\r\n      this.$confirm({\r\n        title: \"删除\",\r\n        content: \"确定删除该分类吗?\",\r\n        okText: \"Yes\",\r\n        okType: \"danger\",\r\n        cancelText: \"No\",\r\n        onOk: () => {\r\n          DeleteCategory(record._id).then(() => {\r\n            this.requestData();\r\n\r\n            this.$notification.success({\r\n              message: \"成功！\",\r\n              description: \"成功删除分类\",\r\n              duration: 2\r\n            });\r\n          });\r\n        },\r\n        onCancel() {\r\n          console.log(\"Cancel\");\r\n        }\r\n      });\r\n    },\r\n\r\n    handleOk() {\r\n      this.confirmLoading = true;\r\n      this.form.validateFields((err, values) => {\r\n        if (!err) {\r\n          console.log(\"Received values of form: \", values);\r\n          UpdateCategory(this.nowId, values)\r\n            .then(res => {\r\n              console.log(res);\r\n              // 数据更新后，重新请求数据\r\n              this.requestData();\r\n\r\n              this.$notification.success({\r\n                message: \"成功！\",\r\n                description: \"成功修改分类\",\r\n                duration: 2\r\n              });\r\n            })\r\n            .catch(() => {\r\n              this.$notification.error({\r\n                message: \"出错！\",\r\n                description: \"已有同名分类\",\r\n                duration: 2\r\n              });\r\n            });\r\n        }\r\n      });\r\n      setTimeout(() => {\r\n        this.visible = false;\r\n        this.confirmLoading = false;\r\n      }, 2000);\r\n    },\r\n\r\n    handleCancel() {\r\n      console.log(\"Clicked cancel button\");\r\n      this.visible = false;\r\n    },\r\n\r\n    requestData() {\r\n      this.loading = true;\r\n      Categories().then(res => {\r\n        // console.log(res)\r\n        for (let item of res) {\r\n          item.key = item._id;\r\n        }\r\n        this.data = res;\r\n        this.loading = false;\r\n      });\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style>\r\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Categories.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Categories.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Categories.vue?vue&type=template&id=118adf4e&\"\nimport script from \"./Categories.vue?vue&type=script&lang=js&\"\nexport * from \"./Categories.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}