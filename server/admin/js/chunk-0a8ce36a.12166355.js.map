{"version":3,"sources":["webpack:///./src/network/adminUser.js","webpack:///./src/views/users/Users.vue?6696","webpack:///src/views/users/Users.vue","webpack:///./src/views/users/Users.vue?9aa0","webpack:///./src/views/users/Users.vue"],"names":["addAdminUser","data","request","url","method","AdminUsers","UpdateAdminUser","id","DeleteAdminUser","render","_vm","this","_h","$createElement","_c","_self","attrs","columns","loading","scopedSlots","_u","key","fn","text","_v","record","on","$event","preventDefault","handleUpdate","showDeleteConfirm","visible","handleOk","handleCancel","form","span","ref","directives","name","rawName","value","rules","required","message","validator","isUnique","expression","initialValue","staticStyle","staticRenderFns","created","requestData","$form","createForm","nowId","title","methods","_id","username","type","console","log","$nextTick","setFieldsValue","$confirm","content","okText","okType","cancelText","onOk","description","duration","onCancel","confirmLoading","validateFields","err","values","res","setTimeout","callback","component"],"mappings":"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","file":"js/chunk-0a8ce36a.12166355.js","sourcesContent":["import request from './request'\r\n\r\nexport function addAdminUser(data){\r\n  return request({\r\n    url: 'adminUser/add',\r\n    method: 'post',\r\n    data: data\r\n  })  \r\n}\r\n\r\nexport function AdminUsers(){\r\n  return request({\r\n    url: 'adminUsers',\r\n    method: \"post\"\r\n  })\r\n}\r\n\r\n// 获取单条数据\r\nexport function GetAdminUser(id){\r\n  return request({\r\n    url: `adminUser/${id}`,\r\n    method: \"get\"\r\n  })\r\n}\r\n\r\nexport function UpdateAdminUser(id, data){\r\n  return request({\r\n    url: `adminUser/${id}`,\r\n    data: data,\r\n    method: \"put\"\r\n  })\r\n}\r\n\r\nexport function DeleteAdminUser(id){\r\n  return request({\r\n    url: `adminUser/${id}`,\r\n    method: \"delete\"\r\n  })\r\n} \r\n\r\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('a-table',{attrs:{\"columns\":_vm.columns,\"data-source\":_vm.data,\"loading\":_vm.loading,\"pagination\":false,\"bordered\":\"\"},scopedSlots:_vm._u([{key:\"type\",fn:function(text){return [(text === 2)?_c('span',[_vm._v(\"超级管理员\")]):_c('span',[_vm._v(\"普通管理员\")])]}},{key:\"action\",fn:function(record){return [_c('span',[_c('a',{on:{\"click\":function($event){$event.preventDefault();return _vm.handleUpdate(record)}}},[_vm._v(\"Update\")]),_c('a-divider',{attrs:{\"type\":\"vertical\"}}),_c('a',{on:{\"click\":function($event){$event.preventDefault();return _vm.showDeleteConfirm(record)}}},[_vm._v(\"Delete\")])],1)]}}])}),_c('a-modal',{attrs:{\"title\":\"修改\",\"visible\":_vm.visible},on:{\"ok\":_vm.handleOk,\"cancel\":_vm.handleCancel}},[_c('a-form',{attrs:{\"form\":_vm.form,\"label-col\":{span: 3},\"wrapper-col\":{ span: 12 }}},[_c('a-form-item',{ref:\"username\",attrs:{\"label\":\"用户名\",\"has-feedback\":\"\"}},[_c('a-input',{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:(['username', { \n          rules: [\n            { required: true, message: '请输入用户名' },\n            { validator: _vm.isUnique, message: '已有同名用户，请更换用户名'}\n          ] \n        }]),expression:\"['username', { \\n          rules: [\\n            { required: true, message: '请输入用户名' },\\n            { validator: isUnique, message: '已有同名用户，请更换用户名'}\\n          ] \\n        }]\"}],attrs:{\"allow-clear\":\"\"}})],1),_c('a-form-item',{attrs:{\"label\":\"用户类型\"}},[_c('a-select',{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:(['type', {initialValue: 1}]),expression:\"['type', {initialValue: 1}]\"}],staticStyle:{\"width\":\"120px\"}},[_c('a-select-option',{attrs:{\"value\":1}},[_vm._v(\"普通管理员\")]),_c('a-select-option',{attrs:{\"value\":2}},[_vm._v(\"超级管理员\")])],1)],1)],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div>\r\n    <a-table :columns=\"columns\" :data-source=\"data\" :loading=\"loading\" :pagination=\"false\" bordered>\r\n      <template slot=\"type\" slot-scope=\"text\">\r\n        <span v-if=\"text === 2\">超级管理员</span>\r\n        <span v-else>普通管理员</span>\r\n      </template>\r\n\r\n      <template slot=\"action\" slot-scope=\"record\">\r\n        <span>\r\n          <a @click.prevent=\"handleUpdate(record)\">Update</a>\r\n          <a-divider type=\"vertical\" />\r\n          <a @click.prevent=\"showDeleteConfirm(record)\">Delete</a>\r\n        </span>\r\n      </template>\r\n    </a-table>\r\n\r\n    <a-modal title=\"修改\" :visible=\"visible\" @ok=\"handleOk\" @cancel=\"handleCancel\">\r\n      <a-form\r\n        :form=\"form\"\r\n        :label-col=\"{span: 3}\"\r\n        :wrapper-col=\"{ span: 12 }\"\r\n      >\r\n        <a-form-item label=\"用户名\" ref=\"username\" has-feedback>\r\n          <a-input\r\n            allow-clear\r\n            v-decorator=\"['username', { \r\n            rules: [\r\n              { required: true, message: '请输入用户名' },\r\n              { validator: isUnique, message: '已有同名用户，请更换用户名'}\r\n            ] \r\n          }]\"\r\n          />\r\n        </a-form-item>\r\n        <a-form-item label=\"用户类型\">\r\n          <a-select v-decorator=\"['type', {initialValue: 1}]\" style=\"width:120px\">\r\n            <a-select-option :value=\"1\">普通管理员</a-select-option>\r\n            <a-select-option :value=\"2\">超级管理员</a-select-option>\r\n          </a-select>\r\n        </a-form-item>\r\n      </a-form>\r\n    </a-modal>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {\r\n  AdminUsers,\r\n  UpdateAdminUser,\r\n  DeleteAdminUser\r\n} from \"network/adminUser.js\";\r\n\r\nconst columns = [\r\n  // {\r\n  //   title: \"Id\",\r\n  //   dataIndex: \"_id\",\r\n  //   width: 1,\r\n  //   key: \"Id\",\r\n  //   // slots: { title: 'customTitle' }, // 自定义表头\r\n  //   // scopedSlots: { customRender: 'name' }, // 自定义表格中的元素\r\n  // },\r\n  {\r\n    title: \"用户名\",\r\n    dataIndex: \"username\",\r\n    width: 1,\r\n    key: \"username\",\r\n    sorter: (a, b) => a.username.length - b.username.length\r\n  },\r\n  {\r\n    title: \"权限\",\r\n    dataIndex: \"type\",\r\n    width: 1,\r\n    key: \"type\",\r\n    scopedSlots: { customRender: \"type\" } // 自定义表格中的元素\r\n  },\r\n  {\r\n    title: \"操作\",\r\n    key: \"action\",\r\n    width: 1,\r\n    scopedSlots: { customRender: \"action\" }\r\n  }\r\n];\r\n\r\nexport default {\r\n  created() {\r\n    this.requestData();\r\n  },\r\n  data() {\r\n    return {\r\n      data: [],\r\n      columns,\r\n      visible: false,\r\n      form: this.$form.createForm(this),\r\n      nowId: null, // 记录正在操作的分类的id\r\n      title: null, //修改的内容\r\n      loading: false\r\n    };\r\n  },\r\n  methods: {\r\n    handleUpdate(record) {\r\n      this.visible = true;\r\n      // console.log(record)\r\n      this.nowId = record._id;\r\n      this.username = record.username;\r\n      this.type = record.type;\r\n      console.log(this.nowId);\r\n\r\n      // 在这里等待弹窗dom出现(其实这里也就第一次加载dom时需要，后来都保存了，但终究对操作不友好)\r\n      this.$nextTick(function() {\r\n        // DOM 现在更新了\r\n        // `this` 绑定到当前实例\r\n        this.form.setFieldsValue({\r\n          username: this.username,\r\n          type: this.type,\r\n        });\r\n      });\r\n    },\r\n\r\n    showDeleteConfirm(record) {\r\n      this.nowId = record._id;\r\n      console.log(record);\r\n      this.$confirm({\r\n        title: \"删除\",\r\n        content: \"确定删除该分类吗?\",\r\n        okText: \"Yes\",\r\n        okType: \"danger\",\r\n        cancelText: \"No\",\r\n        onOk: () => {\r\n          DeleteAdminUser(record._id).then(() => {\r\n            this.requestData();\r\n\r\n            this.$notification.success({\r\n              message: \"成功！\",\r\n              description: \"成功删除分类\",\r\n              duration: 2\r\n            });\r\n          });\r\n        },\r\n        onCancel() {\r\n          console.log(\"Cancel\");\r\n        }\r\n      });\r\n    },\r\n\r\n    handleOk() {\r\n      this.confirmLoading = true;\r\n      this.form.validateFields((err, values) => {\r\n        if (!err) {\r\n          console.log(\"Received values of form: \", values);\r\n          UpdateAdminUser(this.nowId, values).then(res => {\r\n            console.log(res);\r\n            // 数据更新后，重新请求数据\r\n            this.requestData();\r\n\r\n            this.$notification.success({\r\n              message: \"成功！\",\r\n              description: \"成功修改分类\",\r\n              duration: 2\r\n            });\r\n          });\r\n        }\r\n      });\r\n      setTimeout(() => {\r\n        this.visible = false;\r\n        this.confirmLoading = false;\r\n      }, 2000);\r\n    },\r\n\r\n    handleCancel() {\r\n      console.log(\"Clicked cancel button\");\r\n      this.visible = false;\r\n    },\r\n\r\n    requestData() {\r\n      this.loading = true;\r\n      AdminUsers().then(res => {\r\n        // console.log(res)\r\n        for (let item of res) {\r\n          item.key = item._id;\r\n        }\r\n        this.data = res;\r\n        this.loading = false;\r\n      });\r\n    },\r\n\r\n    isUnique(rule, value, callback) {\r\n      console.log(value);\r\n      AdminUsers().then(res => {\r\n        for (const item of res) {\r\n          if (item.username === value) {\r\n            callback(\"已有同名用户，请更换用户名\");\r\n            return;\r\n          }\r\n        }\r\n        callback();\r\n      });\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style>\r\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Users.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Users.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Users.vue?vue&type=template&id=206e0714&\"\nimport script from \"./Users.vue?vue&type=script&lang=js&\"\nexport * from \"./Users.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}