{"version":3,"sources":["webpack:///./src/views/articles/Articles.vue?9380","webpack:///src/views/articles/Articles.vue","webpack:///./src/views/articles/Articles.vue?7c07","webpack:///./src/views/articles/Articles.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","columns","data","loading","scopedSlots","_u","key","fn","record","_l","item","name","_v","_s","on","$event","preventDefault","handleUpdate","showDeleteConfirm","visible","handleOk","handleCancel","ref","form","rules","span","$refs","title","onFieldBlur","model","value","callback","$$v","$set","expression","categories","_id","placeholder","staticRenderFns","created","requestData","content","abstract","nowId","methods","console","log","$confirm","okText","okType","cancelText","onOk","message","description","duration","onCancel","confirmLoading","Form","validate","values","res","setTimeout","components","quillEditor","component"],"mappings":"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","file":"js/chunk-2d0e5f34.8a908312.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('a-table',{attrs:{\"columns\":_vm.columns,\"data-source\":_vm.data,\"loading\":_vm.loading,\"pagination\":false,\"bordered\":\"\"},scopedSlots:_vm._u([{key:\"categories\",fn:function(record){return _vm._l((record),function(item){return _c('a-tag',{key:item.name,attrs:{\"color\":\"green\"}},[_vm._v(_vm._s(item.name))])})}},{key:\"action\",fn:function(record){return [_c('span',[_c('a',{on:{\"click\":function($event){$event.preventDefault();return _vm.handleUpdate(record)}}},[_vm._v(\"Update\")]),_c('a-divider',{attrs:{\"type\":\"vertical\"}}),_c('a',{on:{\"click\":function($event){$event.preventDefault();return _vm.showDeleteConfirm(record)}}},[_vm._v(\"Delete\")])],1)]}}])}),_c('a-modal',{attrs:{\"title\":\"修改\",\"visible\":_vm.visible,\"width\":900},on:{\"ok\":_vm.handleOk,\"cancel\":_vm.handleCancel}},[_c('a-form-model',{ref:\"Form\",attrs:{\"model\":_vm.form,\"rules\":_vm.rules,\"label-col\":{span: 3},\"wrapper-col\":{ span: 20}}},[_c('a-form-model-item',{ref:\"title\",attrs:{\"label\":\"标题\",\"prop\":\"title\"}},[_c('a-input',{on:{\"blur\":function () {_vm.$refs.title.onFieldBlur()}},model:{value:(_vm.form.title),callback:function ($$v) {_vm.$set(_vm.form, \"title\", $$v)},expression:\"form.title\"}})],1),_c('a-form-model-item',{ref:\"categories\",attrs:{\"label\":\"分类\",\"prop\":\"categories\"}},[_c('a-select',{attrs:{\"mode\":\"multiple\"},on:{\"blur\":function () {_vm.$refs.categories.onFieldBlur()}},model:{value:(_vm.form.categories),callback:function ($$v) {_vm.$set(_vm.form, \"categories\", $$v)},expression:\"form.categories\"}},_vm._l((_vm.categories),function(item){return _c('a-select-option',{key:item._id,attrs:{\"value\":item._id}},[_vm._v(_vm._s(item.name))])}),1)],1),_c('a-form-model-item',{ref:\"abstract\",attrs:{\"label\":\"简介\",\"prop\":\"abstract\"}},[_c('a-textarea',{attrs:{\"placeholder\":\"简介\",\"rows\":4},model:{value:(_vm.form.abstract),callback:function ($$v) {_vm.$set(_vm.form, \"abstract\", $$v)},expression:\"form.abstract\"}})],1),_c('a-form-model-item',{ref:\"content\",attrs:{\"label\":\"内容\",\"prop\":\"content\"}},[_c('quill-editor',{attrs:{\"options\":{\n            placeholder: '开始编辑......'\n          }},model:{value:(_vm.form.content),callback:function ($$v) {_vm.$set(_vm.form, \"content\", $$v)},expression:\"form.content\"}})],1)],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div>\r\n    <a-table :columns=\"columns\" :data-source=\"data\" :loading=\"loading\" :pagination=\"false\" bordered>\r\n      <template slot=\"categories\" slot-scope=\"record\">\r\n        <a-tag v-for=\"item in record\" :key=\"item.name\" color=\"green\">{{item.name}}</a-tag>\r\n      </template>\r\n      <template slot=\"action\" slot-scope=\"record\">\r\n        <span>\r\n          <a @click.prevent=\"handleUpdate(record)\">Update</a>\r\n          <a-divider type=\"vertical\" />\r\n          <a @click.prevent=\"showDeleteConfirm(record)\">Delete</a>\r\n        </span>\r\n      </template>\r\n    </a-table>\r\n    <a-modal title=\"修改\" :visible=\"visible\" @ok=\"handleOk\" @cancel=\"handleCancel\" :width=\"900\">\r\n      <a-form-model\r\n        ref=\"Form\"\r\n        :model=\"form\"\r\n        :rules=\"rules\"\r\n        :label-col=\"{span: 3}\"\r\n        :wrapper-col=\"{ span: 20}\"\r\n      >\r\n        <a-form-model-item label=\"标题\" ref=\"title\" prop=\"title\">\r\n          <a-input v-model=\"form.title\" @blur=\"() => {$refs.title.onFieldBlur()}\" />\r\n        </a-form-model-item>\r\n\r\n        <a-form-model-item label=\"分类\" ref=\"categories\" prop=\"categories\">\r\n          <a-select\r\n            v-model=\"form.categories\"\r\n            @blur=\"() => {$refs.categories.onFieldBlur()}\"\r\n            mode=\"multiple\"\r\n          >\r\n            <a-select-option\r\n              v-for=\"(item) in categories\"\r\n              :key=\"item._id\"\r\n              :value=\"item._id\"\r\n            >{{item.name}}</a-select-option>\r\n          </a-select>\r\n        </a-form-model-item>\r\n\r\n        <a-form-model-item label=\"简介\" ref=\"abstract\" prop=\"abstract\">\r\n          <a-textarea v-model=\"form.abstract\" placeholder=\"简介\" :rows=\"4\" />\r\n        </a-form-model-item>\r\n\r\n        <a-form-model-item label=\"内容\" ref=\"content\" prop=\"content\">\r\n          <quill-editor\r\n            :options=\"{\r\n              placeholder: '开始编辑......'\r\n            }\"\r\n            v-model=\"form.content\"\r\n          ></quill-editor>\r\n        </a-form-model-item>\r\n      </a-form-model>\r\n    </a-modal>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { Articles, UpdateArticle, DeleteArticle } from \"network/article.js\";\r\nimport { Categories } from \"network/category.js\";\r\n\r\n// 富文本编辑器\r\nimport \"quill/dist/quill.core.css\";\r\nimport \"quill/dist/quill.snow.css\";\r\nimport \"quill/dist/quill.bubble.css\";\r\n\r\nimport { quillEditor } from \"vue-quill-editor\";\r\n\r\nconst columns = [\r\n  // {\r\n  //   title: \"Id\",\r\n  //   dataIndex: \"_id\",\r\n  //   width: 1,\r\n  //   key: \"Id\"\r\n  //   // slots: { title: 'customTitle' }, // 自定义表头\r\n  //   // scopedSlots: { customRender: 'name' }, // 自定义表格中的元素\r\n  // },\r\n  {\r\n    title: \"标题\",\r\n    dataIndex: \"title\",\r\n    width: 1,\r\n    key: \"Title\",\r\n    sorter: (a, b) => a.title.length - b.title.length\r\n  },\r\n  {\r\n    title: \"分类\",\r\n    dataIndex: \"categories\",\r\n    width: 1,\r\n    scopedSlots: { customRender: \"categories\" } // 自定义表格中的元素\r\n  },\r\n  {\r\n    title: \"操作\",\r\n    key: \"action\",\r\n    width: 1,\r\n    scopedSlots: { customRender: \"action\" }\r\n  }\r\n];\r\n\r\nexport default {\r\n  created() {\r\n    this.requestData();\r\n  },\r\n  data() {\r\n    return {\r\n      data: [],\r\n      columns,\r\n      visible: false,\r\n      categories: [],\r\n      form: {\r\n        title: \"\",\r\n        content: \"\",\r\n        categories: [],\r\n        abstract: \"\"\r\n      },\r\n      rules: {\r\n        title: [{ required: true, message: \"标题不能为空\", trigger: \"blur\" }],\r\n        categories: [\r\n          { required: true, message: \"分类不能为空\", trigger: \"blur\" }\r\n        ]\r\n      },\r\n      nowId: null, // 记录正在操作的分类的id\r\n      title: null, //修改的标题\r\n      loading: false\r\n    };\r\n  },\r\n  methods: {\r\n    handleUpdate(record) {\r\n      this.visible = true;\r\n      // console.log(record)\r\n      this.nowId = record._id;\r\n      this.form.title = record.title;\r\n      this.form.content = record.content;\r\n      this.form.abstract = record.abstract\r\n      // this.form.categories = record.categories[0]._id;\r\n\r\n      // 因为从数据库中拿出后，populate过了所以caregories需要重新置值\r\n      this.form.categories = [];\r\n      for (const item of record.categories) {\r\n        this.form.categories.push(item._id);\r\n      }\r\n\r\n      console.log(record.categories);\r\n      console.log(this.nowId);\r\n    },\r\n\r\n    showDeleteConfirm(record) {\r\n      this.nowId = record._id;\r\n      console.log(record);\r\n      this.$confirm({\r\n        title: \"删除\",\r\n        content: \"确定删除该文章吗?\",\r\n        okText: \"Yes\",\r\n        okType: \"danger\",\r\n        cancelText: \"No\",\r\n        onOk: () => {\r\n          DeleteArticle(record._id).then(() => {\r\n            this.requestData();\r\n\r\n            this.$notification.success({\r\n              message: \"成功！\",\r\n              description: \"成功删除文章\",\r\n              duration: 2\r\n            });\r\n          });\r\n        },\r\n        onCancel() {\r\n          console.log(\"Cancel\");\r\n        }\r\n      });\r\n    },\r\n\r\n    handleOk() {\r\n      this.confirmLoading = true;\r\n      this.$refs.Form.validate(validate => {\r\n        if (validate) {\r\n          let values = {\r\n            title: this.form.title,\r\n            content: this.form.content,\r\n            categories: this.form.categories,\r\n            abstract: this.form.abstract\r\n          };\r\n\r\n          if (values.abstract === ''){\r\n            values.abstract = values.title\r\n          }\r\n\r\n          console.log(\"Received values of form: \", values);\r\n          UpdateArticle(this.nowId, values).then(res => {\r\n            console.log(res);\r\n            // 数据更新后，重新请求数据\r\n            this.requestData();\r\n\r\n            this.$notification.success({\r\n              message: \"成功！\",\r\n              description: \"成功修改文章\",\r\n              duration: 2\r\n            });\r\n          });\r\n        }\r\n      });\r\n      setTimeout(() => {\r\n        this.visible = false;\r\n        this.confirmLoading = false;\r\n      }, 2000);\r\n    },\r\n\r\n    handleCancel() {\r\n      console.log(\"Clicked cancel button\");\r\n      this.visible = false;\r\n    },\r\n\r\n    requestData() {\r\n      this.loading = true;\r\n      Categories().then(res => {\r\n        this.categories = res;\r\n      });\r\n      Articles().then(res => {\r\n        // console.log(res)\r\n        for (let item of res) {\r\n          item.key = item._id;\r\n        }\r\n        this.data = res;\r\n        this.loading = false;\r\n      });\r\n    }\r\n  },\r\n  components: {\r\n    quillEditor\r\n  }\r\n};\r\n</script>\r\n\r\n<style>\r\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Articles.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Articles.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Articles.vue?vue&type=template&id=659803b6&\"\nimport script from \"./Articles.vue?vue&type=script&lang=js&\"\nexport * from \"./Articles.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}